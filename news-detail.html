<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¨Ø± â€“ Khotwa</title>

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/design-system.css">
  <link rel="stylesheet" href="/assets/khotwa-redesign.css">
  <link rel="stylesheet" href="/assets/enhanced-navbar.css">

  <style>
    body { padding-top: 100px !important; background-color: #fff; }
    .news-detail-wrapper { max-width: 800px; margin: 0 auto 60px; padding: 0 20px; }
    
    /* Ø¥ØµÙ„Ø§Ø­ Ù…Ù‚Ø§Ø³Ø§Øª ØµÙˆØ±Ø© Ø§Ù„Ø®Ø¨Ø± */
    .news-main-img-container {
      width: 100%;
      border-radius: 16px;
      overflow: hidden;
      margin: 30px 0;
      background: #f1f5f9;
    }
    .news-main-img {
      width: 100%;
      max-height: 500px;
      object-fit: cover; /* ÙŠÙ…Ù†Ø¹ ØªÙ…Ø·ÙŠØ· Ø§Ù„ØµÙˆØ±Ø© */
      display: block;
    }

    .news-article-body { 
      font-size: 1.2rem; 
      line-height: 1.8; 
      color: #334155; 
      text-align: justify;
    }
    .news-article-body p { margin-bottom: 20px; }
    
    .loading-state { text-align: center; padding: 100px 0; color: #64748b; }
    
    [hidden] { display: none !important; }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="container nav-inner">
    <a class="brand" href="/index.html">
      <img src="/assets/apple-touch-icon.png" class="logo" alt="Logo">
      <span data-lang="ar">Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</span>
      <span data-lang="en" hidden>Khotwa Council</span>
    </a>
    <button id="menu-toggle" class="menu-toggle">â˜°</button>
    <div class="nav-links" id="primary-nav">
      <a href="/index.html"><span data-lang="ar">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span><span data-lang="en" hidden>Home</span></a>
      <a href="/news.html" class="active"><span data-lang="ar">Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</span><span data-lang="en" hidden>News</span></a>
      <a href="/about.html"><span data-lang="ar">Ù…Ù† Ù†Ø­Ù†</span><span data-lang="en" hidden>About</span></a>
      <button id="lang-btn" class="lang-toggle">English</button>
    </div>
  </div>
</nav>

<main id="news-content">
  <div class="loading-state">
    <span data-lang="ar">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¨Ø±...</span>
    <span data-lang="en" hidden>Loading news...</span>
  </div>
</main>

<script src="/js/config.js"></script>
<script src="/js/language-toggle.js"></script>
<script src="/js/menu-toggle.js"></script>

<script>
async function loadNewsDetail() {
  const urlParams = new URLSearchParams(window.location.search);
  const id = urlParams.get('id');
  const lang = localStorage.getItem('khotwa_lang') || 'ar';
  const container = document.getElementById('news-content');

  if (!id) { window.location.href = '/news.html'; return; }

  try {
    // Ø¬Ù„Ø¨ Ø§Ù„Ø®Ø¨Ø± Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø§Ù„Ù€ ID Ù„ØªØ¬Ù†Ø¨ ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±
    const response = await fetch(`https://khotwabknd-gj8oeubw.manus.space/api/news/${id}`);
    if (!response.ok) throw new Error('Not Found');
    
    const news = await response.json();

    const title = lang === 'ar' ? (news.titleAr || news.title) : (news.titleEn || news.title);
    const content = lang === 'ar' ? (news.contentAr || news.content) : (news.contentEn || news.content);
    const image = news.imageUrl || news.image || '';

    container.innerHTML = `
      <div class="news-detail-wrapper">
        <header>
          <h1 style="font-size: 2.2rem; color: #1e293b; margin-bottom: 10px;">${title}</h1>
          <p style="color: #64748b;">ğŸ“… ${new Date(news.createdAt).toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-US')}</p>
        </header>

        ${image ? `
          <div class="news-main-img-container">
            <img src="${image}" class="news-main-img" alt="${title}">
          </div>
        ` : ''}

        <article class="news-article-body">
          ${content.split('\n').map(p => p.trim() ? `<p>${p}</p>` : '').join('')}
        </article>
      </div>
    `;
  } catch (e) {
    container.innerHTML = `
      <div class="loading-state">
        <p>${lang === 'ar' ? 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø¨Ø±.' : 'Sorry, news not found.'}</p>
        <a href="/news.html">${lang === 'ar' ? 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø®Ø¨Ø§Ø±' : 'Back to News'}</a>
      </div>`;
  }
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ù„Ø¨ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
loadNewsDetail();

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ø¨Ø¯ÙˆÙ† Ø±ÙŠÙØ±Ø´
document.getElementById('lang-btn').addEventListener('click', () => {
  setTimeout(loadNewsDetail, 100);
});
</script>

</body>
</html>
