<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¨Ø± â€“ Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</title>

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/design-system.css">
  <link rel="stylesheet" href="/assets/khotwa-redesign.css">
  <link rel="stylesheet" href="/assets/enhanced-navbar.css">

  <script>
    window.KHOTWA_CONFIG = {
      API_BASE: 'https://khotwabknd-gj8oeubw.manus.space/api'
    };
  </script>

  <style>
    body {
      padding-top: 100px;
      background: #ffffff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }

    main { flex: 1; }

    .news-detail-wrapper {
      max-width: 850px;
      margin: 0 auto 60px;
      padding: 0 20px;
    }

    .news-main-img-container {
      width: 100%;
      border-radius: 20px;
      overflow: hidden;
      margin: 30px 0;
      background: #f8fafc;
    }

    .news-main-img {
      width: 100%;
      max-height: 550px;
      object-fit: cover;
      display: block;
    }

    .news-article-body {
      font-size: 1.25rem;
      line-height: 1.8;
      color: #334155;
    }

    .news-article-body p {
      margin-bottom: 24px;
    }

    .loading-state {
      text-align: center;
      padding: 120px 0;
      color: #94a3b8;
    }

    @media (max-width: 960px) {
      #primary-nav {
        display: none;
        flex-direction: column;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        padding: 20px;
        border-bottom: 2px solid #1e40af;
        box-shadow: 0 10px 15px rgba(0,0,0,0.1);
        z-index: 1000;
      }

      #primary-nav[data-open="true"] {
        display: flex !important;
      }

      .menu-toggle {
        display: block !important;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1.5rem;
      }
    }

    [hidden] { display: none !important; }
  </style>

  <script src="/assets/khotwa-api.js"></script>
</head>

<body>

<nav class="navbar">
  <div class="container nav-inner">
    <a class="brand" href="/index.html">
      <img src="/apple-touch-icon.png" class="logo" alt="Logo">
      <span data-lang="ar">Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</span>
      <span data-lang="en" hidden>Khotwa Council</span>
    </a>

    <button id="menu-toggle" class="menu-toggle" aria-label="Menu" aria-expanded="false">
      â˜°
    </button>

    <div class="nav-links" id="primary-nav" data-open="false">
      <a href="/index.html">
        <span data-lang="ar">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        <span data-lang="en" hidden>Home</span>
      </a>
      <a href="/news.html" class="active">
        <span data-lang="ar">Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</span>
        <span data-lang="en" hidden>News</span>
      </a>
      <a href="/events.html">
        <span data-lang="ar">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª</span>
        <span data-lang="en" hidden>Events</span>
      </a>
      <button id="lang-toggle-btn" class="lang-toggle" aria-label="Toggle language">
        <span data-lang="ar">English</span>
        <span data-lang="en" hidden>Ø¹Ø±Ø¨ÙŠ</span>
      </button>
    </div>
  </div>
</nav>

<main id="news-content">
  <div class="loading-state">
    <span data-lang="ar">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¨Ø±...</span>
    <span data-lang="en" hidden>Loading...</span>
  </div>
</main>

<footer class="main-footer" style="background:#f8fafc;border-top:1px solid #e2e8f0;padding:4rem 0;">
  <div class="container">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:2rem;">
      <div>
        <strong data-lang="ar">Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</strong>
        <strong data-lang="en" hidden>Khotwa Council</strong>
        <p style="color:#64748b;font-size:0.95rem;margin-top:10px;">
          Â© 2026 | Ù…Ù„Ø¨ÙˆØ±Ù†ØŒ Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§
        </p>
      </div>
      <div style="display:flex;gap:1.5rem;">
        <a href="https://instagram.com/khotwa.sc" target="_blank" rel="noopener noreferrer">
          Instagram
        </a>
        <a href="/contact.html" data-lang="ar">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
        <a href="/contact.html" data-lang="en" hidden>Contact Us</a>
      </div>
    </div>
  </div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

  /* ===== Language ===== */
  const updateLanguage = (lang) => {
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.querySelectorAll('[data-lang]').forEach(el => {
      el.hidden = el.dataset.lang !== lang;
    });
    localStorage.setItem('khotwa_lang', lang);
  };

  updateLanguage(localStorage.getItem('khotwa_lang') || 'ar');

  document.getElementById('lang-toggle-btn')?.addEventListener('click', () => {
    updateLanguage(document.documentElement.lang === 'ar' ? 'en' : 'ar');
    loadNewsDetail();
  });

  /* ===== Menu Toggle ===== */
  const menuToggle = document.getElementById('menu-toggle');
  const nav = document.getElementById('primary-nav');

  menuToggle?.addEventListener('click', () => {
    const open = nav.dataset.open === 'true';
    nav.dataset.open = (!open).toString();
    menuToggle.setAttribute('aria-expanded', (!open).toString());
  });

  /* ===== Load News Detail ===== */
  window.loadNewsDetail = async function () {
    const params = new URLSearchParams(window.location.search);
    const id = Number(params.get('id'));
    const container = document.getElementById('news-content');
    const lang = document.documentElement.lang;

    if (!id) {
      window.location.href = '/news.html';
      return;
    }

    try {
      const response = await KhotwaAPI.getNews();
      const items = Array.isArray(response) ? response : (response?.result?.data || []);
      const news = items.find(n => Number(n.id) === id);

      if (!news) throw new Error('Not found');

      const title = lang === 'ar'
        ? (news.titleAr || news.title)
        : (news.titleEn || news.title);

      const content = lang === 'ar'
        ? (news.contentAr || news.content)
        : (news.contentEn || news.content);

      const image = news.imageUrl || news.image || news.coverImage || '/apple-touch-icon.png';

      container.innerHTML = `
        <div class="news-detail-wrapper">
          <header>
            <h1>${title}</h1>
            <p style="color:#64748b;margin-bottom:30px;">
              ğŸ“… ${news.date || '2026'}
            </p>
          </header>

          <div class="news-main-img-container">
            <img src="${image}" class="news-main-img" onerror="this.src='/apple-touch-icon.png'">
          </div>

          <article class="news-article-body">
            ${
              content
                ? content.split('\n')
                    .filter(p => p.trim())
                    .map(p => `<p>${p}</p>`)
                    .join('')
                : ''
            }
          </article>
        </div>
      `;
    } catch (e) {
      console.error(e);
      container.innerHTML = `
        <div class="loading-state">
          ${lang === 'ar'
            ? 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø±.'
            : 'News not found.'}
        </div>
      `;
    }
  };

  loadNewsDetail();
});
</script>

</body>
</html>
