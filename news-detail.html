<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¨Ø± â€“ Khotwa</title>

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/design-system.css">
  <link rel="stylesheet" href="/assets/khotwa-redesign.css">
  <link rel="stylesheet" href="/assets/enhanced-navbar.css">
  <link rel="stylesheet" href="/assets/comments-and-registration.css"/>

  <style>
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØµÙ…ÙŠÙ… ØµÙØ­Ø© Ø§Ù„Ø®Ø¨Ø± */
    .news-detail-wrapper {
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .back-nav {
      margin-bottom: 30px;
    }

    .btn-back {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: #64748b;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.2s;
    }

    .btn-back:hover {
      color: var(--primary-color, #0284c7);
    }

    .news-header {
      margin-bottom: 40px;
    }

    .news-category-badge {
      background: #e0f2fe;
      color: #0284c7;
      padding: 6px 16px;
      border-radius: 50px;
      font-size: 0.85rem;
      font-weight: 700;
      display: inline-block;
      margin-bottom: 15px;
    }

    .news-title-main {
      font-size: clamp(1.8rem, 5vw, 2.8rem);
      line-height: 1.3;
      font-weight: 900;
      color: #1e293b;
      margin-bottom: 20px;
    }

    .news-meta-info {
      display: flex;
      gap: 20px;
      color: #94a3b8;
      font-size: 0.95rem;
      border-bottom: 1px solid #f1f5f9;
      padding-bottom: 20px;
    }

    .news-main-img {
      width: 100%;
      border-radius: 24px;
      margin: 30px 0;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      object-fit: cover;
    }

    .news-article-body {
      font-size: 1.2rem;
      line-height: 1.9;
      color: #334155;
      text-align: justify;
    }

    .news-article-body p {
      margin-bottom: 25px;
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¹ØµØ±ÙŠØ© */
    .share-section {
      margin-top: 50px;
      padding: 30px;
      background: #f8fafc;
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .share-grid {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .share-icon-btn {
      padding: 12px 24px;
      border-radius: 12px;
      color: white;
      text-decoration: none;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: transform 0.2s;
    }

    .share-icon-btn:hover {
      transform: translateY(-3px);
    }

    .tw-bg { background: #000; }
    .fb-bg { background: #1877f2; }
    .wa-bg { background: #25d366; }

    .loading-state {
      text-align: center;
      padding: 100px 0;
    }

    @media (max-width: 768px) {
      .news-article-body { font-size: 1.1rem; }
    }
  </style>

  <script src="/assets/khotwa-api.js"></script>
</head>

<body>

<nav class="navbar">
  <div class="container nav-inner">
    <a class="brand" href="/index.html">
      <img src="/assets/apple-touch-icon.png" class="logo" alt="Logo">
      <span data-lang="ar">Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</span>
    </a>
    <div class="nav-links" id="primary-nav">
      <a href="/index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="/news.html" class="active">Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</a>
      <a href="/events.html">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª</a>
      <button class="lang-toggle" id="lang-toggle">English</button>
    </div>
  </div>
</nav>

<main id="news-detail-content">
  <div class="loading-state">
    <div class="skeleton-text" style="width: 60%; margin: 0 auto 20px;"></div>
    <p>Ø¬Ø§Ø±Ù Ø¬Ù„Ø¨ Ø§Ù„Ø®Ø¨Ø± Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø³...</p>
  </div>
</main>

<footer style="background:#f8fafc; border-top:1px solid #e2e8f0; padding:4rem 0; margin-top:4rem;">
  <div class="container">
    <div style="display:flex; flex-wrap:wrap; justify-content:space-between; align-items:center;">
      <p>Â© <span id="year"></span> Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</p>
      <a href="https://instagram.com/khotwa.sc" style="color:#e1306c; font-weight:bold;">Instagram</a>
    </div>
  </div>
</footer>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

async function loadDetail() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get('id');
  const lang = localStorage.getItem('khotwa_lang') || 'ar';
  
  if (!id) {
    window.location.href = '/news.html';
    return;
  }

  try {
    const allNews = await KhotwaAPI.getNews();
    const news = allNews.find(n => n.id == id);

    if (!news) throw new Error("Not found");

    const title = lang === 'ar' ? (news.titleAr || news.titleEn) : (news.titleEn || news.titleAr);
    const content = lang === 'ar' ? (news.contentAr || news.contentEn) : (news.contentEn || news.contentAr);
    const date = new Date(news.createdAt).toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-AU', {
      year: 'numeric', month: 'long', day: 'numeric'
    });

    const shareUrl = encodeURIComponent(window.location.href);
    const shareTitle = encodeURIComponent(title);

    document.getElementById('news-detail-content').innerHTML = `
      <div class="news-detail-wrapper">
        <div class="back-nav">
          <a href="/news.html" class="btn-back">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø®Ø¨Ø§Ø±</a>
        </div>

        <header class="news-header">
          <span class="news-category-badge">${news.category || 'Ø®Ø¨Ø±'}</span>
          <h1 class="news-title-main">${title}</h1>
          <div class="news-meta-info">
            <span>ğŸ“… ${date}</span>
            <span>ğŸ‘¤ Ù…Ø¬Ù„Ø³ Ø®Ø·ÙˆØ©</span>
          </div>
        </header>

        ${news.image ? `<img src="${news.image}" class="news-main-img" alt="${title}" onerror="this.style.display='none'">` : ''}

        <article class="news-article-body">
          ${content.split('\n').map(p => p.trim() ? `<p>${p}</p>` : '').join('')}
        </article>

        <section class="share-section">
          <h3>Ù…Ø´Ø§Ø±ÙƒØ© Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø±</h3>
          <div class="share-grid">
            <a href="https://twitter.com/intent/tweet?text=${shareTitle}&url=${shareUrl}" target="_blank" class="share-icon-btn tw-bg">ğ• ØªÙˆÙŠØªØ±</a>
            <a href="https://wa.me/?text=${shareTitle}%20${shareUrl}" target="_blank" class="share-icon-btn wa-bg">ÙˆØ§ØªØ³Ø§Ø¨</a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=${shareUrl}" target="_blank" class="share-icon-btn fb-bg">ÙÙŠØ³Ø¨ÙˆÙƒ</a>
          </div>
        </section>
      </div>
    `;

  } catch (err) {
    document.getElementById('news-detail-content').innerHTML = `
      <div style="text-align:center; padding:100px 0;">
        <h2>Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø¨Ø±</h2>
        <a href="/news.html" class="btn-back">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</a>
      </div>
    `;
  }
}

loadDetail();
</script>

<script src="/js/menu-toggle.js"></script>
<script src="/js/language-toggle.js"></script>

</body>
</html>
