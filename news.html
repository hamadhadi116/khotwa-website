<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title data-lang="ar">الأخبار – Khotwa</title>
  <title data-lang="en" hidden>News – Khotwa</title>
  <meta name="description" content="آخر أخبار مجلس طلاب خطوة في جامعة لا تروب – إعلانات، فعاليات، وفرص.">
  <link rel="canonical" href="https://khotwastudentcouncil.com/news.html"/>
  <meta name="robots" content="index,follow"/>
  <meta name="color-scheme" content="light dark"/>
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0a0f1a" media="(prefers-color-scheme: dark)">

  <!-- OG/Twitter -->
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="Khotwa Student Council"/>
  <meta property="og:title" content="الأخبار – Khotwa"/>
  <meta property="og:description" content="آخر أخبار مجلس طلاب خطوة في ملبورن."/>
  <meta property="og:url" content="https://khotwastudentcouncil.com/news.html"/>
  <meta property="og:image" content="https://b.top4top.io/p_35166f7hr1.jpg"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="الأخبار – Khotwa"/>
  <meta name="twitter:description" content="آخر أخبار مجلس طلاب خطوة."/>
  <meta name="twitter:image" content="https://b.top4top.io/p_35166f7hr1.jpg"/>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Blog",
    "name":"Khotwa News",
    "url":"https://khotwastudentcouncil.com/news.html",
    "inLanguage":"ar",
    "publisher":{"@type":"Organization","name":"Khotwa Student Council","url":"https://khotwastudentcouncil.com/"}
  }
  </script>

  <style>
    /* أنماط CSS مثل السابق */

    .grid{display:grid;gap:1rem}
    .grid-3{grid-template-columns:repeat(3,1fr)}
    @media(max-width:980px){.grid-3{grid-template-columns:1fr}}
    .post{background:#fff;border:1px solid var(--ring);border-radius:16px;overflow:hidden;box-shadow:var(--sh-sm);display:flex;flex-direction:column}
    .post img{width:100%;height:auto;aspect-ratio:16/9;object-fit:cover;background:#f3f4f6}
    .post .body{padding:1rem}
    .post h3{margin:0 0 .4rem;font-size:1.05rem}
  </style>
</head>
<body>
  <!-- الشريط العلوي والقائمة -->
  <main class="container" id="main">
    <section>
      <div class="section-head">
        <h1 data-lang="ar">الأخبار</h1>
        <h1 data-lang="en" hidden>News</h1>
      </div>
      <p class="muted" data-lang="ar">كل جديد عن مجلس طلاب خطوة: إعلانات، مبادرات، ونتائج فعاليات.</p>
      <p class="muted" data-lang="en" hidden>All updates about Khotwa Student Council: announcements, initiatives, and recaps.</p>

      <!-- أدوات الفلترة -->
      <div class="tools" style="margin-top:1rem">
        <div class="search" role="search">
          <input id="q" type="search" placeholder="ابحث في الأخبار…" aria-label="ابحث في الأخبار">
        </div>
        <button class="chip" data-filter="all" data-active="true" aria-pressed="true">الكل</button>
        <button class="chip" data-filter="ann">إعلانات</button>
        <button class="chip" data-filter="event">فعاليات</button>
        <button class="chip" data-filter="media">تغطيات</button>
      </div>
    </section>

    <!-- عرض الأخبار -->
    <section aria-live="polite">
      <div class="grid grid-3" id="posts">
        <!-- سيتم ملؤها تلقائيًا من data/news.json -->
      </div>
    </section>
  </main>

  <script>
    async function loadNews(){
      try {
        const res = await fetch('/data/news.json', { cache:'no-cache' });
        if (!res.ok) throw new Error('Failed to load news.json');
        const data = await res.json();
        const postsEl = document.getElementById('posts');
        postsEl.innerHTML = '';

        if(!Array.isArray(data) || data.length === 0) {
          postsEl.innerHTML = '<div class="muted">لا توجد أخبار حالياً.</div>';
          return;
        }

        data.sort((a,b) => new Date(b.date) - new Date(a.date));

        data.forEach(item => {
          const article = document.createElement('article');
          article.className = 'post';
          const tagsLower = (item.tags || []).map(t => String(t).toLowerCase());
          const typeTag = tagsLower.find(t => ['ann','event','media'].includes(t)) || 'ann';
          article.dataset.tags = typeTag;

          const arDate = new Date(item.date).toLocaleDateString('ar-EG');
          const enDate = new Date(item.date).toLocaleDateString('en-AU');

          article.innerHTML = `
            ${item.image ? `<img src="${item.image}" alt="${(item.title?.ar || '').replace(/"/g, '&quot;')}" loading="lazy" decoding="async">` : `<div style="aspect-ratio:16/9;background:#f3f4f6"></div>`}
            <div class="body">
              <div class="meta">
                <span>${arDate}</span>
                <span>${enDate}</span>
                <span>•</span>
                <span>${(item.tags || []).join('، ')}</span>
              </div>
              <h3>${item.title?.ar || ''}</h3>
              <p class="muted">${item.summary?.ar || ''}</p>
            </div>
          `;
          postsEl.appendChild(article);
        });
      } catch (err) {
        console.error('فشل تحميل الأخبار:', err);
      }
    }
    loadNews();
  </script>
</body>
</html>
