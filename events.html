<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª â€“ Khotwa</title>
  
  <meta name="description" content="ØªØ§Ø¨Ø¹ Ø£Ø­Ø¯Ø« ÙØ¹Ø§Ù„ÙŠØ§Øª ÙˆØ£Ù†Ø´Ø·Ø© Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ© ÙÙŠ Ù…Ù„Ø¨ÙˆØ±Ù†. Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù† ÙˆØ´Ø§Ø±Ùƒ ÙÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ©.">
  <link rel="canonical" href="https://khotwastudentcouncil.com/events.html"/>
  
  <style>
    :root {
      --primary: #1e40af; --primary-hover: #1d4ed8;
      --text: #0f172a; --muted: #64748b;
      --surface: #ffffff; --card: #f8fafc;
      --ring: #e2e8f0; --r-lg: 16px;
      --sh-md: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    }

    * { box-sizing: border-box; transition: all 0.2s ease; }
    body {
      margin: 0; font-family: system-ui, -apple-system, sans-serif;
      color: var(--text); background: var(--surface); line-height: 1.6;
    }
    .container { width: min(1200px, 92%); margin-inline: auto; }

    /* Navbar */
    .navbar {
      position: sticky; top: 0; z-index: 100;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px); border-bottom: 1px solid var(--ring);
      padding: 0.75rem 0;
    }
    .nav-inner { display: flex; justify-content: space-between; align-items: center; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 1.2rem; }
    .brand img { width: 35px; height: 35px; border-radius: 8px; }

    /* Section Head */
    .section-head { padding: 3rem 0 1rem; text-align: center; }
    .section-head h1 { font-size: 2.5rem; margin-bottom: 0.5rem; color: var(--primary); }

    /* Filters & Search */
    .tools-bar {
      display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 2rem;
      align-items: center; justify-content: center;
    }
    .search-box {
      position: relative; flex: 1; min-width: 300px;
    }
    .search-box input {
      width: 100%; padding: 0.8rem 1rem; padding-right: 2.5rem;
      border: 1px solid var(--ring); border-radius: 12px; outline: none;
    }
    .search-box svg { position: absolute; right: 12px; top: 30%; color: var(--muted); }

    .filter-group { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .chip {
      padding: 0.5rem 1.2rem; border-radius: 20px; border: 1px solid var(--ring);
      background: white; cursor: pointer; font-size: 0.9rem; font-weight: 500;
    }
    .chip[data-active="true"] { background: var(--primary); color: white; border-color: var(--primary); }

    /* Grid & Cards */
    .events-grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.5rem; padding-bottom: 4rem;
    }
    .event-card {
      background: white; border: 1px solid var(--ring); border-radius: var(--r-lg);
      overflow: hidden; cursor: pointer; display: flex; flex-direction: column;
    }
    .event-card:hover { transform: translateY(-5px); box-shadow: var(--sh-md); }
    
    .card-img-wrapper { position: relative; width: 100%; aspect-ratio: 16/9; }
    .card-img-wrapper img { width: 100%; height: 100%; object-fit: cover; }
    .category-badge {
      position: absolute; top: 12px; left: 12px;
      background: rgba(30, 64, 175, 0.9); color: white;
      padding: 4px 12px; border-radius: 12px; font-size: 0.75rem;
    }

    .card-body { padding: 1.25rem; flex-grow: 1; }
    .card-meta { display: flex; gap: 10px; font-size: 0.85rem; color: var(--muted); margin-bottom: 0.8rem; }
    .card-body h3 { margin: 0 0 0.5rem 0; font-size: 1.2rem; }
    .card-body p { font-size: 0.9rem; color: var(--muted); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

    /* Skeletons */
    .skeleton { height: 350px; background: #eee; border-radius: 16px; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }

    /* Dark Mode */
    @media (prefers-color-scheme: dark) {
      :root { --surface: #0f172a; --text: #f1f5f9; --ring: #1e293b; --card: #1e293b; }
      body { background: var(--surface); }
      .navbar, .event-card, .chip { background: #1e293b; color: white; }
      .search-box input { background: #1e293b; color: white; }
    }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="container nav-inner">
      <a href="/index.html" class="brand">
        <img src="/assets/apple-touch-icon.png" alt="Logo">
        <span>Ù…Ø¬Ù„Ø³ Ø·Ù„Ø§Ø¨ Ø®Ø·ÙˆØ©</span>
      </a>
      <div id="nav-links">
        <a href="/index.html" style="padding: 0 10px;">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a href="/events.html" style="color: var(--primary); font-weight: bold;">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª</a>
      </div>
    </div>
  </nav>

  <main class="container">
    <header class="section-head">
      <h1 data-lang="ar">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h1>
      <p class="muted">Ø§ÙƒØªØ´Ù ÙˆØ´Ø§Ø±Ùƒ ÙÙŠ ÙØ¹Ø§Ù„ÙŠØ§ØªÙ†Ø§ Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ø¨Ù…Ø¯ÙŠÙ†Ø© Ù…Ù„Ø¨ÙˆØ±Ù†</p>
    </header>

    <div class="tools-bar">
      <div class="search-box">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="7"/><path d="m21 21-4.3-4.3"/></svg>
        <input type="text" id="eventSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙØ¹Ø§Ù„ÙŠØ© Ø¨Ø§Ø³Ù…Ù‡Ø§...">
      </div>
      <div class="filter-group">
        <button class="chip" data-filter="all" data-active="true">Ø§Ù„ÙƒÙ„</button>
        <button class="chip" data-filter="social">Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</button>
        <button class="chip" data-filter="educational">ØªØ¹Ù„ÙŠÙ…ÙŠ</button>
        <button class="chip" data-filter="cultural">Ø«Ù‚Ø§ÙÙŠ</button>
      </div>
    </div>

    <div class="events-grid" id="eventsContainer">
      <div class="skeleton"></div>
      <div class="skeleton"></div>
      <div class="skeleton"></div>
    </div>
  </main>

  <script src="/assets/khotwa-api.js"></script>
  <script>
    let currentCategory = 'all';
    let searchQuery = '';

    async function renderEvents() {
      const container = document.getElementById('eventsContainer');
      
      try {
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù€ API
        const events = await KhotwaAPI.searchEvents(searchQuery, currentCategory !== 'all' ? currentCategory : null);
        
        if (!events || events.length === 0) {
          container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 3rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ¹Ø§Ù„ÙŠØ§Øª ØªØ·Ø§Ø¨Ù‚ Ø¨Ø­Ø«Ùƒ Ø­Ø§Ù„ÙŠØ§Ù‹.</div>';
          return;
        }

        container.innerHTML = events.map(ev => {
          const date = new Date(ev.date || ev.eventDate).toLocaleDateString('ar-EG', {
            day: 'numeric', month: 'long'
          });
          
          return `
            <article class="event-card" onclick="location.href='/event-detail.html?id=${ev.id}'">
              <div class="card-img-wrapper">
                <span class="category-badge">${ev.category || 'Ø¹Ø§Ù…'}</span>
                <img src="${ev.imageUrl || '/assets/default-event.jpg'}" alt="${ev.titleAr}" 
                     onerror="this.src='/assets/apple-touch-icon.png'">
              </div>
              <div class="card-body">
                <div class="card-meta">
                  <span>ğŸ“… ${date}</span>
                  <span>ğŸ“ ${ev.location || 'Ù…Ù„Ø¨ÙˆØ±Ù†'}</span>
                </div>
                <h3>${ev.titleAr || ev.title}</h3>
                <p>${ev.descriptionAr || 'Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ù…Ø¬Ù„Ø³ Ø®Ø·ÙˆØ©.'}</p>
                <div style="margin-top: 1rem; color: var(--primary); font-weight: 600; font-size: 0.85rem;">
                   Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„ â†
                </div>
              </div>
            </article>
          `;
        }).join('');

      } catch (err) {
        container.innerHTML = '<p>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª.</p>';
      }
    }

    // Event Listeners Ù„Ù„Ø¨Ø­Ø«
    document.getElementById('eventSearch').addEventListener('input', (e) => {
      searchQuery = e.target.value;
      renderEvents(); // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© debounce Ù‡Ù†Ø§ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
    });

    // Event Listeners Ù„Ù„ÙÙ„Ø§ØªØ±
    document.querySelectorAll('.chip').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.chip').forEach(b => b.dataset.active = 'false');
        btn.dataset.active = 'true';
        currentCategory = btn.dataset.filter;
        renderEvents();
      });
    });

    // Ø§Ù„Ø¨Ø¯Ø¡ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.addEventListener('DOMContentLoaded', renderEvents);
  </script>
</body>
</html>
