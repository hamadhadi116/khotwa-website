<!DOCTYPE html>
<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="color-scheme" content="light dark"/>
  <title>مجلس طلاب خطوة – Khotwa</title>
  <meta name="description" content="مجلس طلاب خطوة يمثل طلاب برنامج خطوة في جامعة لا تروب – ملبورن. فعاليات، أخبار، وانضمام للمجلس.">
  <link rel="canonical" href="https://khotwastudentcouncil.com/index.html"/>
  <meta name="robots" content="index,follow"/>

  <!-- Theme color -->
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0a0f1a"   media="(prefers-color-scheme: dark)">

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" href="/assets/favicon.ico">

  <!-- OG/Twitter -->
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="Khotwa Student Council"/>
  <meta property="og:title" content="مجلس طلاب خطوة – Khotwa"/>
  <meta property="og:description" content="فعاليات، أخبار، وخدمات موجهة لطلاب خطوة في ملبورن."/>
  <meta property="og:url" content="https://khotwastudentcouncil.com/index.html"/>
  <meta property="og:image" content="/assets/apple-touch-icon.png"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="مجلس طلاب خطوة – Khotwa"/>
  <meta name="twitter:description" content="فعاليات، أخبار، وخدمات لطلاب خطوة."/>
  <meta name="twitter:image" content="/assets/apple-touch-icon.png"/>

  <!-- Structured Data (Schema.org) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Khotwa Student Council",
    "alternateName": "مجلس طلاب خطوة",
    "url": "https://khotwastudentcouncil.com/",
    "logo": "https://khotwastudentcouncil.com/assets/apple-touch-icon.png",
    "image": "https://khotwastudentcouncil.com/assets/img/photo-2025-04-26-21-25-14.webp",
    "description": "مجلس طلاب خطوة يمثل طلاب برنامج خطوة في جامعة لا تروب - ملبورن. نعمل على دعم الطلاب أكاديمياً واجتماعياً وثقافياً.",
    "sameAs": [
      "https://www.instagram.com/khotwa.sc/"
    ],
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Melbourne",
      "addressRegion": "VIC",
      "addressCountry": "AU"
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "Student Services",
      "availableLanguage": ["Arabic", "English"]
    }
  }
  </script>

  <!-- Critical CSS -->
  <style>
    :root{
      --bg:#ffffff;--text:#0f172a;--muted:#64748b;--ring:#e5e7eb;--primary:#1e40af;
      --card:#ffffff;--elev:0 1px 2px rgba(15,23,42,.04)
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b1220;--text:#e5e7eb;--muted:#94a3b8;--ring:#1f2a44;--primary:#93c5fd;
        --card:#0f172a;--elev:0 1px 2px rgba(0,0,0,.4)
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:var(--bg);color:var(--text);
      font-family:"Segoe UI",system-ui,-apple-system,Tahoma,Arial,sans-serif;line-height:1.6
    }
    a{color:inherit;text-decoration:none}
    a:focus-visible,button:focus-visible{outline:2px solid var(--primary);outline-offset:2px;border-radius:6px}
    .container{width:min(1120px,92%);margin-inline:auto}
    .skip-link{position:absolute;inset-inline-start:0;top:-40px;background:#000;color:#fff;padding:.5rem 1rem;z-index:100}
    .skip-link:focus{top:0}

    .navbar{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--ring);z-index:40;backdrop-filter:saturate(140%) blur(8px)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:.8rem 0}
    .brand{display:flex;align-items:center;gap:.6rem;font-weight:700}
    .logo{border-radius:8px;box-shadow:var(--elev)}
    .menu-toggle{display:inline-flex;align-items:center;gap:.4rem;border:1px solid var(--ring);background:var(--card);color:var(--text);padding:.4rem .6rem;border-radius:.5rem;cursor:pointer}
    .nav-links{display:flex;gap:1rem;align-items:center}
    .nav-links a{padding:.4rem .2rem;border-radius:.5rem}
    .lang-toggle{border:1px solid var(--ring);background:var(--card);color:var(--text);padding:.4rem .6rem;border-radius:.5rem;cursor:pointer}

    @media (max-width:960px){
      .nav-links{
        position:absolute;inset-inline:0;top:64px;background:var(--card);border-bottom:1px solid var(--ring);
        padding:1rem;flex-direction:column;display:none
      }
      .nav-links[data-open="true"]{display:flex}
    }

    .hero{padding:2.5rem 0}
    .hero-inner{display:grid;grid-template-columns:1.2fr .8fr;gap:2rem;align-items:center}
    @media (max-width:980px){.hero-inner{grid-template-columns:1fr}}
    h1{margin:0 0 .6rem 0;font-size:clamp(1.6rem,3vw,2.2rem)}
    p{margin:.3rem 0 1rem}
    .cta-row{display:flex;gap:.8rem;flex-wrap:wrap}
    .btn{display:inline-block;padding:.7rem 1rem;border-radius:.6rem;border:1px solid var(--primary)}
    .btn-primary{background:var(--primary);color:#0b1220}
    .btn-outline{background:transparent;color:var(--primary)}
    .hero-img img{width:100%;height:auto;border-radius:12px;display:block;box-shadow:var(--elev)}

    .section-head{display:flex;align-items:center;justify-content:space-between;margin:1.8rem 0 1rem}
    .grid{display:grid;gap:1rem}
    .grid-2{grid-template-columns:repeat(2,1fr)}
    .grid-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:960px){.grid-2,.grid-3{grid-template-columns:1fr}}
    .card{border:1px solid var(--ring);border-radius:12px;padding:1rem;background:var(--card);box-shadow:var(--elev)}
    .muted{color:var(--muted)}
    footer{border-top:1px solid var(--ring);margin-top:2rem;padding:1rem 0;background:var(--card)}
    .foot{display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap}

    @media (prefers-reduced-motion: reduce){
      *{animation-duration:.01ms !important;animation-iteration-count:1 !important;transition-duration:.01ms !important;scroll-behavior:auto !important}
    }
  </style>

  <!-- تحميل CSS خارجي -->
  <link rel="preload" href="/assets/main.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/main.min.css"></noscript>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HCS6PYK04X"></script>
  <script src="/assets/analytics.js"></script>
  <link rel="stylesheet" href="/assets/pagination.css">
  <link rel="stylesheet" href="/assets/advanced-filters.css">
  <link rel="stylesheet" href="/assets/feedback.css">
  <link rel="alternate" type="application/rss+xml" title="أخبار مجلس طلاب خطوة" href="/feed.xml">
</head>
<body>
  <!-- Skip link (لغتين) -->
  <a class="skip-link" href="#main" data-lang="ar">تخطَّ إلى المحتوى</a>
  <a class="skip-link" href="#main" data-lang="en" hidden aria-hidden="true">Skip to content</a>

  <!-- Navbar -->
  <nav class="navbar" aria-label="الشريط العلوي">
    <div class="container nav-inner">
      <a class="brand" href="/index.html" aria-label="العودة للرئيسية" aria-current="page">
        <img src="/assets/apple-touch-icon.png" class="logo" alt="شعار مجلس طلاب خطوة" width="40" height="40" decoding="async" loading="lazy">
        <span data-lang="ar">مجلس طلاب خطوة</span>
        <span data-lang="en" hidden aria-hidden="true">Khotwa Student Council</span>
      </a>

      <button id="menu-toggle" class="menu-toggle" type="button"
              aria-controls="primary-nav" aria-expanded="false" aria-label="فتح وإغلاق القائمة">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M4 7h16M4 12h16M4 17h16"/></svg>
        <span data-lang="ar">القائمة</span><span data-lang="en" hidden aria-hidden="true">Menu</span>
      </button>

      <div class="nav-links" id="primary-nav" data-open="false" aria-hidden="true">
        <a href="/about.html"><span data-lang="ar">من نحن</span><span data-lang="en" hidden aria-hidden="true">About</span></a>
        <a href="/news.html"><span data-lang="ar">الأخبار</span><span data-lang="en" hidden aria-hidden="true">News</span></a>
        <a href="/events.html"><span data-lang="ar">الفعاليات</span><span data-lang="en" hidden aria-hidden="true">Events</span></a>
        <a href="/calendar.html"><span data-lang="ar">التقويم</span><span data-lang="en" hidden aria-hidden="true">Calendar</span></a>
        <a href="/gallery.html"><span data-lang="ar">معرض الصور</span><span data-lang="en" hidden aria-hidden="true">Gallery</span></a>
        <a href="/faq.html"><span data-lang="ar">الأسئلة الشائعة</span><span data-lang="en" hidden aria-hidden="true">FAQ</span></a>
        <a href="/resources.html"><span data-lang="ar">الموارد</span><span data-lang="en" hidden aria-hidden="true">Resources</span></a>
        <a href="/contact.html"><span data-lang="ar">تواصل</span><span data-lang="en" hidden aria-hidden="true">Contact</span></a>
        <button id="lang-toggle" class="lang-toggle" type="button" aria-pressed="false" aria-label="تبديل اللغة">English</button>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <header class="hero">
    <div class="container hero-inner">
      <div>
        <!-- H1 واحد مع لغتين -->
        <h1>
          <span data-lang="ar">مجلس طلاب خطوة – صوت الطالب  </span>
          <span data-lang="en" hidden aria-hidden="true">Khotwa Student Council – Students’ Voice   </span>
        </h1>
        <p data-lang="ar">نمكّن طلاب برنامج خطوة أكاديميًا واجتماعيًا وثقافيًا، ونبني الجسر بين الطلاب والمجتمع بفعاليات نوعية وخدمات موجهة.</p>
        <p data-lang="en" hidden aria-hidden="true">We empower Khotwa students academically, socially, and culturally, and we build a bridge between students and the community through quality events and tailored services.</p>
        <div class="cta-row">
          <a href="/register.html" class="btn btn-primary"><span data-lang="ar">قدّم للعضوية</span><span data-lang="en" hidden aria-hidden="true">Apply for Membership</span></a>
          <a href="/events.html" class="btn btn-outline"><span data-lang="ar">شاهد أقرب الفعاليات</span><span data-lang="en" hidden aria-hidden="true">See Upcoming Events</span></a>
        </div>
      </div>
      <div class="hero-img">
        <img
          src="https://b.top4top.io/p_35166f7hr1.jpg"
          alt="مجموعة طلاب مجلس خطوة – La Trobe"
          width="1600" height="900"
          loading="eager" decoding="async" fetchpriority="high"
          referrerpolicy="no-referrer"
          srcset="https://b.top4top.io/p_35166f7hr1.jpg 1600w,
                  https://b.top4top.io/p_35166f7hr1.jpg 1200w,
                  https://b.top4top.io/p_35166f7hr1.jpg 800w"
          sizes="(max-width:980px) 92vw, 50vw">
      </div>
    </div>
  </header>

  <main id="main">
    <!-- About -->
    <section aria-labelledby="about-ar" class="container">
      <div class="section-head">
        <h2 id="about-ar" data-lang="ar">من نحن</h2>
        <h2 id="about-en" data-lang="en" hidden aria-hidden="true">About Us</h2>
        <a class="muted" href="/about.html"><span data-lang="ar">المزيد</span><span data-lang="en" hidden aria-hidden="true">Learn more</span></a>
      </div>
      <div class="grid grid-2">
        <article class="card"><h3 data-lang="ar">الرؤية</h3><h3 data-lang="en" hidden aria-hidden="true">Vision</h3><p data-lang="ar">دعم العملية التعليمية وخدمة المجتمع الجامعي.</p><p data-lang="en" hidden aria-hidden="true">Support the learning journey and serve our university community.</p></article>
        <article class="card"><h3 data-lang="ar">الرسالة</h3><h3 data-lang="en" hidden aria-hidden="true">Mission</h3><p data-lang="ar">تمكين الطلاب وتعزيز علاقتهم بالإدارة الجامعية.</p><p data-lang="en" hidden aria-hidden="true">Empower students and strengthen ties with university administration.</p></article>
        <article class="card"><h3 data-lang="ar">الأهداف</h3><h3 data-lang="en" hidden aria-hidden="true">Goals</h3><p data-lang="ar">التمثيل، القيادة، التفاعل المجتمعي، والدعوة.</p><p data-lang="en" hidden aria-hidden="true">Representation, leadership, community engagement, and advocacy.</p></article>
        <article class="card"><h3 data-lang="ar">التنظيم</h3><h3 data-lang="en" hidden aria-hidden="true">Structure</h3><p data-lang="ar">رئيس ونائب وقادة فرق ومنسقو الأنشطة والإعلام.</p><p data-lang="en" hidden aria-hidden="true">President, Vice President, team leads, and activity/media coordinators.</p></article>
      </div>
    </section>

    <!-- Events (ديناميكي من /data/events.json) -->
    <section aria-labelledby="events-ar" class="container">
      <div class="section-head">
        <h2 id="events-ar" data-lang="ar">الفعاليات القادمة</h2>
        <h2 id="events-en" data-lang="en" hidden aria-hidden="true">Upcoming Events</h2>
        <a class="muted" href="/events.html"><span data-lang="ar">تقويم الفعاليات</span><span data-lang="en" hidden aria-hidden="true">All events</span></a>
      </div>

      <div class="grid grid-3" id="home-events" aria-live="polite">
        <!-- يتم تعبئته عبر جافاسكربت -->
      </div>
      <p id="home-events-empty" class="muted" hidden>
        <span data-lang="ar">لا توجد فعاليات حالياً.</span>
        <span data-lang="en" hidden aria-hidden="true">No upcoming events at the moment.</span>
      </p>
    </section>
  </main>

  <!-- Footer -->
  <footer aria-label="تذييل الموقع">
    <div class="container foot">
      <div class="muted">© <span id="year"></span> Khotwa Student Council</div>
      <a href="https://www.instagram.com/khotwa.sc/" target="_blank" rel="noopener noreferrer">Instagram</a>
    </div>
  </footer>

  <!-- Helpers -->
  <script>
    // سنة الحقوق
    (function(){
      const y=document.getElementById('year');
      if(y) y.textContent=new Date().getFullYear();
    })();

    // منيو الجوال + وصولية
    (function(){
      const btn = document.getElementById('menu-toggle');
      const nav = document.getElementById('primary-nav');
      if(!btn || !nav) return;

      const mq  = window.matchMedia('(min-width:961px)');

      function setMenu(open){
        nav.setAttribute('data-open', String(open));
        btn.setAttribute('aria-expanded', String(open));
        // على سطح المكتب تبقى ظاهرة دائمًا، على الجوال تُخفى إذا كانت مغلقة
        nav.setAttribute('aria-hidden', String(!open && !mq.matches));
        if(open){
          const focusable = nav.querySelector('a,button');
          (focusable || btn).focus();
        }
      }

      function init(){
        // حالة أولية متسقة مع CSS
        setMenu(false);
        nav.setAttribute('aria-hidden', mq.matches ? 'false' : 'true');
      }
      init();

      btn.addEventListener('click', ()=> setMenu(nav.getAttribute('data-open')!=='true'));

      mq.addEventListener('change', (e)=>{
        // عند الانتقال بين الشاشات نغلق القائمة على الجوال ونُظهرها على الديسكتوب
        setMenu(false);
        nav.setAttribute('aria-hidden', e.matches ? 'false':'true');
      });

      document.addEventListener('click', (e)=>{
        const open = nav.getAttribute('data-open')==='true';
        const target = e.target;
        if(!open) return;
        if(target instanceof Node && !nav.contains(target) && !btn.contains(target)){
          setMenu(false);
        }
      });

      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') setMenu(false); });

      // إغلاق القائمة عند اختيار رابط
      nav.addEventListener('click', (e)=>{
        const t = (e.target instanceof Element) ? e.target.closest('a') : null;
        if(t) setMenu(false);
      });
    })();

    // تبديل اللغة + حفظ التفضيل
    (function(){
      const t=document.getElementById('lang-toggle'); if(!t) return;

      function isEn(){ return localStorage.getItem('khotwa_lang')==='en'; }

      function set(lang){
        document.querySelectorAll('[data-lang]').forEach(el=>{
          const want = el.getAttribute('data-lang')===lang;
          el.hidden = !want;
          el.setAttribute('aria-hidden', String(!want));
        });
        t.textContent = (lang==='ar')?'English':'العربية';
        t.setAttribute('aria-pressed', String(lang!=='ar')); /* زر تبديل وفق WAI-ARIA */
        document.documentElement.lang = (lang==='ar')?'ar':'en';
        document.documentElement.dir  = (lang==='ar')?'rtl':'ltr';
        localStorage.setItem('khotwa_lang', lang);
      }

      set(isEn()?'en':'ar');
      t.addEventListener('click',()=> set(isEn()?'ar':'en'));
    })();

    // تحميل أقرب 3 فعاليات للصفحة الرئيسية من /data/events.json
    (function(){
      const container = document.getElementById('home-events');
      const emptyMsg  = document.getElementById('home-events-empty');
      if(!container) return;

      function escapeHtml(str){
        return String(str || '').replace(/[&<>"]/g, s=>(
          {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[s] || s
        ));
      }

      async function loadHomeEvents(){
        try{
          const res = await fetch('/data/events.json?ts=' + Date.now(), { cache:'no-store' });
          if(!res.ok) throw new Error('HTTP ' + res.status);
          const data = await res.json();

          // يدعم إما { items:[...] } أو [ ... ]
          const items = Array.isArray(data.items) ? data.items : (Array.isArray(data) ? data : []);
          if(!items.length){
            emptyMsg.hidden = false;
            return;
          }

          const today = new Date();
          const upcoming = items
            .map(ev => ({ ...ev, _date: ev.date ? new Date(ev.date) : null }))
            .filter(ev => ev._date && !isNaN(ev._date) && ev._date >= today)
            .sort((a,b)=> a._date - b._date)
            .slice(0,3);

          if(!upcoming.length){
            emptyMsg.hidden = false;
            return;
          }

          const langPref = localStorage.getItem('khotwa_lang') === 'en' ? 'en' : 'ar';
          const isEn = langPref === 'en';

          container.innerHTML = '';

          upcoming.forEach(ev=>{
            const d = ev._date;
            const arDate = d ? d.toLocaleDateString('ar-EG',{year:'numeric',month:'long',day:'numeric'}) : '';
            const enDate = d ? d.toLocaleDateString('en-AU',{year:'numeric',month:'long',day:'numeric'}) : '';

            const titleAr   = ev.title?.ar   || ev.title   || '';
            const titleEn   = ev.title?.en   || ev.title   || '';
            const summaryAr = ev.summary?.ar || ev.summary || '';
            const summaryEn = ev.summary?.en || ev.summary || '';
            const locAr     = ev.location    || '';
            const locEn     = ev.location_en || ev.location || '';

            const article = document.createElement('article');
            article.className = 'card';
            article.innerHTML = `
              <h3>
                <span data-lang="ar" ${isEn?'hidden aria-hidden="true"':''}>${escapeHtml(titleAr)}</span>
                <span data-lang="en" ${!isEn?'hidden aria-hidden="true"':''}>${escapeHtml(titleEn)}</span>
              </h3>
              <p class="muted">
                <span data-lang="ar" ${isEn?'hidden aria-hidden="true"':''}>${escapeHtml(summaryAr)}</span>
                <span data-lang="en" ${!isEn?'hidden aria-hidden="true"':''}>${escapeHtml(summaryEn)}</span>
              </p>
              <p class="muted">
                <span data-lang="ar" ${isEn?'hidden aria-hidden="true"':''}>
                  ${arDate ? 'التاريخ: '+escapeHtml(arDate) : ''}${locAr ? (arDate ? ' – ' : '') + 'المكان: '+escapeHtml(locAr) : ''}
                </span>
                <span data-lang="en" ${!isEn?'hidden aria-hidden="true"':''}>
                  ${enDate ? 'Date: '+escapeHtml(enDate) : ''}${locEn ? (enDate ? ' – ' : '') + 'Location: '+escapeHtml(locEn) : ''}
                </span>
              </p>
            `;
            container.appendChild(article);
          });
        }catch(err){
          console.error('Failed to load home events', err);
          if(emptyMsg){
            emptyMsg.hidden = false;
            emptyMsg.querySelector('[data-lang="ar"]').textContent = 'تعذّر تحميل الفعاليات.';
            const enSpan = emptyMsg.querySelector('[data-lang="en"]');
            if(enSpan) enSpan.textContent = 'Could not load events.';
          }
        }
      }

      loadHomeEvents();
    })();
  </script>

  <!-- Netlify Identity widget + تحويل رابط الدعوة تلقائيًا -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    // إذا وصل المستخدم برابط دعوة يحمل #invite_token، حوّله مباشرة إلى /admin/
    if (location.hash && location.hash.startsWith('#invite_token=')) {
      location.replace('/admin/' + location.hash);
    }
    // بعد تسجيل الدخول عبر الودجت، انقل المستخدم إلى لوحة الإدارة
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('login', () => { window.location.href = '/admin/'; });
    }
  </script>

  <!-- نظامك (إن وُجد) -->
  <script src="/assets/cms-boot.min.js" defer></script>
  
  <!-- الميزات المحسّنة -->
  <link rel="stylesheet" href="/assets/features.min.css">
  <script src="/assets/features.min.js" defer></script>
  <script src="/assets/pagination.js"></script>
  <script src="/assets/advanced-filters.js"></script>
  <script src="/assets/feedback.js"></script>
  <script src="/assets/newsletter.js"></script>
  <script src="/assets/form-validation.js"></script>
</body>
</html>
